<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.chendi.jiyi.dao.UserDAO">
	<!-- <resultMap type="Picture" id="UserMap"> <id property="id" column="id" 
		/> <result property="name" column="name" /> <result property="password" column="password" 
		/> <result property="institute" column="institute" /> <result property="specialty" 
		column="specialty" /> <result property="sex" column="sex" /> <result property="picture" 
		column="picture" /> <result property="qq" column="qq" /> <result property="phone" 
		column="phone" /> <result property="email" column="email" /> <result property="status" 
		column="status" /> <result property="auditor" column="auditor" /> <result 
		property="wealth" column="wealth" /> <result property="release_num" column="release_num" 
		/> <result property="reward_num" column="reward_num" /> <result property="credit" 
		column="credit" /> <result property="dissension_num" column="dissension_num" 
		/> <result property="create_time" column="create_time" /> <association property="realName" 
		column="id" select="com.chendi.jiyi.dao.PictureDAO.queryRelease" /> </resultMap> -->
	<!-- 目的:为dao接口方法提供sql语句配置 -->
	<insert id="addUser" parameterType="User">
		insert into user
		(id,name,password,signature,institute,specialty,sex,picture,qq,email,
		status,auditor,wealth,release_num,reward_num,buy_release_num,accept_reward_num,credit,dissension_num,create_time,real_name)
		values(#{id},#{name},#{password},#{signature},#{institute},#{specialty},#{sex},#{picture},#{qq},#{email},
		#{status},#{auditor},#{wealth},#{releaseNum},#{rewardNum},#{buyReleaseNum},#{acceptRewardNum},#{credit},#{dissensionNum},#{createTime},#{realName})
	</insert>

	<update id="updateStatus">
		update user
		set status=#{status},auditor=#{auditor}
		where id=#{id}
	</update>

	<select id="login" resultType="User">
		select
		id,name,password,signature,institute,specialty,sex,picture,email,status,auditor,release_num,reward_num,wealth,credit,dissension_num,create_time
		from user
		where id=#{id} and password=#{password}
	</select>

	<select id="queryById" resultType="User">
		select
		id,name,password,signature,institute,specialty,sex,picture,email,qq,status,auditor,release_num,reward_num,wealth,credit,dissension_num,create_time,real_name
		from user
		<where>
			<if test="id!=null">
				id=#{id}
			</if>
			<if test="status!=null">
				and status=#{status}
			</if>
		</where>
	</select>

	<select id="queryName" resultType="User" parameterType="String">
		select
		id,name,picture,signature,release_num,reward_num,credit
		from user
		where id=#{id};
	</select>

	<select id="queryWealthById" resultType="int" parameterType="String">
		select wealth
		from user
		where id=#{id};
	</select>

	<select id="queryAll" resultType="User">
		select
		id,name,password,signature,institute,specialty,sex,email,
		status,auditor,wealth,release_num,reward_num,credit,dissension_num,create_time
		from user
	</select>

	<select id="queryByStatus" resultType="User">
		select
		id,name,signature,institute,specialty,sex,email,create_time
		from user
		where
		status=#{status}
		order by create_time ASC
	</select>

	<select id="queryAllNotActive" resultType="User">
		select
		id,name,password,institute,specialty,sex,email,
		status,auditor,wealth,release_num,reward_num,credit,dissension_num,create_time
		from user
		where status=0
	</select>

	<update id="updateStatusById">
		update user
		set
		status=#{status},auditing_msg=#{auditingMsg}
		<if test="auditor!=null and auditor!=''">
			,auditor=#{auditor}
		</if>
		where id=#{id}
	</update>

	<update id="updateById">
		update user
		set
		password=#{password},institute=#{institute},specialty=#{specialty},sex=#{sex},picture=#{picture}
		,qq=#{qq},email=#{email},status=#{status},wealth=#{wealth},create_time=#{createTime},real_name=#{realName}
		where id=#{id}
	</update>

	<update id="updatePicById">
		update user
		set
		picture=#{picture}
		where id=#{id}
	</update>

	<update id="updateWealth">
		update user
		set wealth=wealth+#{wealth}
		where id=#{id}
	</update>

</mapper>